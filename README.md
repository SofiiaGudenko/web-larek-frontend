# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/styles/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

## Архитектура приложения

Код приложения разделен на слои согласно парадигме MVP:
- слой представления, отвечает за отображения данных на странице,
- слой данных, отвечает за хранения и изменение данных,
- презентер, отвечает за связь представления и данных.

## Базовый код

### 1. Класс Api

Отвечает за работу запросов к серверу, содержит в себе логику отправки запросов. Его функции: получение и отправление данных на сервер, принимает такие аргументы:

baseUrl: string // базовая ссылка
options: RequestInit = {} // настройки запроса Класс
handleResponse() // проверяет ответ от сервера

Методы:
- 'get' - выполняет GET запрос на переданный в параметрах ендпоинт и возвращает промис с объектом, которым ответил сервер
- 'post' - выполняет 'POST' запрос по умолчанию, но метод запроса может быть переопределен заданием третьего параметра при вызове


### 2. Класс Component<T>

Данный класс является абстрактным классом компонента. Предназначен для создания компонентов пользовательского интерфейса. Конструктор принимает контейнер HTMLElement, где будет находиться компонент. Класс обладает следующими методами:

- 'toggleClass' - переключает классы
- 'setText' - устанавливает текстовое содержимое для элемента
- 'setDisabled' - меняет статус элемента на активный/неактивный
- 'setHidden' - скрывает элемент
- 'setVisible' - делает элемент видимым
- 'setImage' - устанавливает изображение с атрибутом alt
- 'render' - возвращает DOM-элемент

### 3. Класс Model<T>

Данный класс является абстрактным и представляет собой базовую модель. Конструктор принимает следующие аргументы:

data: Partial - частичные данные
events: IEvents - содержит метод emitChanges(), который оповещает о том, что модель изменилась

### 4. Класс EventEmitter

Данный класс позволяет отправлять и подписываться на события, происходящие в системе. Имеет следующие методы:

- 'on' - подписывает на событие
- 'off'- отписывает от события
- 'emit'- инициализация события
- 'trigger' - возвращает функцию, при вызове которой инициализируется требуемое в параметрах событие

## Описание классов модели данных

### 1. Класс Product

 Класс используется для здания и управления данными продукта. Имеет следующие свойства:

id: number; // Уникальный идентификатор товара
name: string; // Название товара
description: string; // Описание товара
price: number | null; // Цена товара
category: string; // Категория товара
imageUrl: string; // URL изображения товара

### 2. Класс IAppState

Данный класс является наследником Model. Он хранит состояние приложения, каталог продуктов, корзину, заказ, данные для предварительного просмотра, ошибки формы. Использует интерфейс IAppState. Конструктор класса принимает начальное состояние приложения, а также инициализирует свойства класса catalog, basket, order, preview и formErrors. Содержит следующие методы:

catalog: IProduct[]; // Список товаров
order: IOrder | null; // Текущий заказ
basket: IProduct[] | null; // Содержимое корзины
preview: string | null; // Превью товара
loading: boolean; // Индикатор загрузки данных

## Классы компонентов представления

### 1. Класс Modal
Класс Modal обеспечивает работу модального окна и наследуется от Component. Его функции: открытие и закрытие модального окна с подробной информацией. Конструктор принимает constructor(container: HTMLElement, protected events: IEvents) - контейнер модального окна и объект для управления событиями. Также в конструкторе происходит инициализация кнопки закрытия окна и контейнера с контентом. Включает в себя методы:

- 'set content' - заменяет контент на значение
- 'open' - открывает модальное окно
- 'close' - закрывает модальное окно
- 'render' - возвращает контейнер

### 2. Класс Form<T>
Данный класс наследует класс Component. Конструктор принимает constructor(container: HTMLFormElement, events: IEvents) - контейнер формы и объект для управлением событиями в качестве параметров, а также выполняет инициализацию _submit и _errors. Устанавливает обработчики события на ввод данных и отправку формы. Свойство valid устанавливает отключенное состояние для кнопки отправки формы. Свойство errors устанавливает текст ошибки. Содержит следующие методы:

- 'onInputChange' - следит за изменениями формы
- 'render' - отрисовка формы
- 'set valid' - управляет доступностью кнопки отправки в зависимости от валидности формы
- 'set errors' - устанавливает и отображает ошибки валидации формы

### 3. Класс Basket
Данный класс наследует Component. Конструктор принимает HTML-элемент и события. В нем инициализируется список товаров, итоговая сумма и кнопка. Также содержит функцию, которая добавляет обработчик событий на кнопку и возвращает массив товаров. Класс имеет следующие свойства и методы:

- 'items' - устанавливает текст для пустой корзины или вставляет товары
- 'total' - устанавливает текст с итоговой суммой
- 'toggleButton' - включение/отключение кнопки оформления заказа

### 4. Класс Success
Класс является наследником Component. Конструктор принимает constructor(container: HTMLFormElement, events: IEvents) - контейнер и объект для управлением событиями в качестве параметров. Выполняется инициализация _close и _description. Свойство description предоставляет доступ к содержимому элемента. Класс имеет следующие методы:

- 'get description' - получает текст описания
- 'set description' - устанавливает текст описания

### 5. Класс OrderForm
Данный класс является наследником класса Form и принимает обобщенный параметр IContactForm. Конструктор класса принимает контейнер формы, объект событий и объект actions, содержащий действия, выполняемые при нажатии на кнопку. Также устанавливаются обработчики событий клика на кнопки оплаты. Имеет следующие методы:

- 'addButtonClickHandler' - обрабатывает события клика на кнопки оплаты
- 'toggleButtons' - изменяет визуальное состояние кнопок оплаты
- 'address' - получает и устанавливает значение адреса в форме заказа

### 6. Класс ShopApi
Данный класс является наследником класса Api. Конструктор принимает cdn, baseUrl и options. Класс содержит следующие методы:

- 'getItemList' - возвращает массив товаров
- 'getItem' - возвращает один товар
- 'orderItems' - реализует функцию заказа

### 7. Класс Card
Данный класс является наследником класса Component. Конструктор класса принимает контейнер, в котором будет отображаться карточка, и действия, которые будут выполняться при клике на карточку или кнопку. Он имеет следующие свойства и методы:

- 'disableButton' - отключает кнопку при нулевой цене
- id - устанавливает и получает идентификатор карточки
- buttonText - устанавливает текст кнопки
- title - устанавливает и получает заголовок карточки
- price - устанавливает и получает цену карточки
- image - устанавливает и получает картинку карточки
- category - устанавливает и получает категорию карточки
- index - устанавливает и получает индекс карточки

### 8. Класс Page
Данный класс наследуется от базового класса Component и принимает обобщенный параметр IPage. Конструктор класса принимает constructor(container: HTMLElement, events: IEvents) - контейнер страницы и объект для управлением событий. Имеет следующие свойства, методы и функции:

- функция 'ensureElement' - инициализирует свойства с HTML-элементами
- 'handleBasketClick' - обрабатывает события клика на элемент корзины
- 'counter' - установка значения счетчика товаров в корзине
- 'gallery' - установка элемента галереи товаров
- 'locked' - установка состояния блокировки страницы

## Описание данных

### IProduct
**Описание:** Представляет товар в каталоге. 
**Функции:**
- Идентификация товара (id).
- Хранение информации о названии, описании, цене, категории и изображении.

### BasketItem
**Описание:** Обеспечивает управление корзиной. 
**Функции:**
- Добавление товара в корзину.
- Удаление товара из корзины.
- Хранение товаров, которые выбраны пользователем.

### IOrderContacts
**Описание:** Представляет контактные данные покупателя.

### IOrderDeliveryForm 
**Описание:** Представляет форму для заполнения информации о доставке.

### IAppState
**Описание:** Хранит текущее состояние приложения.

### IPage
**Описание:** Управляет страницей приложения.

### ICard
**Описание:** Представляет карточку товара на экране.

### IOrderFormError 
**Описание:** Объединяет ошибки контактов и формы доставки.
Все поля из IOrderContacts и IOrderDeliveryForm могут иметь ошибку.

### IOrder
**Описание:** Представляет заказ, включающий элементы заказа и общую сумму.

### IOrderSuccess
**Описание:** Содержит информацию об успешно завершенном заказе.

### ILarekAPI
**Описание:** Интерфейс для взаимодействия с сервером.

### FormError
**Описание:** Тип для представления ошибок формы.
Использует частичное сопоставление ключей объекта IOrder с ошибками.

## Описание компонентов

### CatalogComponent
**Описание:** Отображает каталог товаров. 
**Функции:**
- Загружает список товаров через ILarekAPI.getProductList().
- При клике на товар открывается модальное окно с детальной информацией.

### BasketComponent
**Описание:** Отображает товары, добавленные в корзину. 
**Функции:**
- Позволяет добавлять и удалять товары.
- Показывает итоговую стоимость заказа.

### OrderComponent
**Описание:** Управляет процессом оформления заказа. 
**Функции:**

- Получает информацию о способе оплаты и адресе доставки.
- Проверяет правильность введенных данных.
- При успешном вводе передает заказ на сервер через ILarekAPI.orderProduct().